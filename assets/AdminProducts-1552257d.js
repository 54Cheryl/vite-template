import{P as M,L as I}from"./PaginationView-ffea13f9.js";import{m as C,D as T}from"./DelModal-89620bf7.js";import{T as b,S as P}from"./swalToast-e6838973.js";import{_ as w,o as r,c as n,a as t,bu as i,bk as d,F as v,p as x,d as U,h as A,bg as D,r as h,b as _,w as L,t as u}from"./index-bb24c539.js";const{VITE_APP_URL:E,VITE_APP_PATH:N}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_APP_PATH:"cheryl-hexschool",BASE_URL:"/vite-template/",MODE:"production",DEV:!1,PROD:!0},R={props:{product:{},isNew:{}},data(){return{tempProduct:{},modal:"",imgUploading:!1}},mixins:[C],emits:["update-product","cancel-product","create-images"],watch:{product(){this.tempProduct=this.product,this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.imageUrl||(this.tempProduct.imageUrl="")}},methods:{uploadFile(){this.imgUploading=!0;const l=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",l),this.$http.post(`${E}api/${N}/admin/upload`,e,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{a.data.success?(this.tempProduct.tempImage=a.data.imageUrl,this.$refs.fileInput.value="",this.imgUploading=!1,b.fire({icon:"success",title:"上傳成功",text:a.data.message})):(this.$refs.fileInput.value="",this.imgUploading=!1,b.fire({icon:"error",title:"上傳失敗",text:a.data.message}))}).catch(a=>{this.imgUploading=!1,P.fire({icon:"error",title:a.response.data.message})})}}},F={class:"modal fade",id:"productModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},O={class:"modal-dialog modal-xl"},B={class:"modal-content"},H={class:"modal-header bg-dark text-white"},S={class:"modal-title",id:"exampleModalLabel"},j={key:0},q={key:1},z=t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),G={class:"modal-body"},J={action:"",class:"row"},K={class:"col-4"},Q={class:"col"},W=t("label",{class:"form-label mt-2",for:"prodMainImg"},"主要圖片",-1),X=["src"],Y=t("p",{class:"fs-4 mt-2"},"多圖新增",-1),Z={class:"mb-3"},$=t("label",{for:"prodOtherImg",class:"form-label"},"圖片網址",-1),tt=["onUpdate:modelValue"],et=["src"],ot={key:0},st={key:1},lt={key:1},it={class:"col mt-5"},dt={for:"customFile",class:"fs-4 form-label"},rt={key:0,class:"fas fa-spinner fa-spin"},nt=t("label",{for:"fileLink",class:"form-label mt-2"},"檔案生成網址",-1),at={class:"col-8"},ct={class:"row"},pt={class:"col-6"},mt=t("label",{class:"form-label mt-2",for:"prodTitle"},"品名",-1),ut={class:"col-6"},ht=t("label",{class:"form-label mt-2",for:"prodCategory"},"類別",-1),_t={class:"row"},ft={class:"col-6"},gt=t("label",{class:"form-label mt-2",for:"prodPlace"},"產地",-1),Pt={class:"col-6"},bt=t("label",{class:"form-label mt-2",for:"prodVariety"},"品種",-1),vt={class:"row"},yt={class:"col-6"},Ut=t("label",{class:"form-label mt-2",for:"prodAroma"},"香氣",-1),wt={class:"col-6"},xt=t("label",{class:"form-label mt-2",for:"prodTaste"},"滋味",-1),kt={class:"row"},Vt={class:"col-6"},Mt=t("label",{class:"form-label mt-2",for:"prodDried"},"茶乾",-1),It={class:"col-6"},Ct=t("label",{class:"form-label mt-2",for:"prodUnit"},"單位",-1),Tt={class:"row"},At={class:"col-6"},Dt=t("label",{class:"form-label mt-2",for:"prodOrigin"},"原價",-1),Lt={class:"col-6"},Et=t("label",{class:"form-label mt-2",for:"prodPrice"},"售價",-1),Nt=t("label",{class:"form-label mt-2",for:"prodDescription"},"產品描述",-1),Rt=t("label",{class:"form-label mt-2",for:"prodContent"},"說明內容",-1),Ft={class:"col mt-2"},Ot=t("label",{class:"form-label ms-2",for:"prodEnabled"},"是否啟用",-1),Bt={class:"modal-footer"};function Ht(l,e,a,k,o,c){return r(),n("div",F,[t("div",O,[t("div",B,[t("div",H,[t("h5",S,[a.isNew?(r(),n("span",j,"新增產品")):(r(),n("span",q,"編輯產品"))]),z]),t("div",G,[t("form",J,[t("div",K,[t("div",Q,[W,i(t("input",{type:"text",class:"form-control mb-2",id:"prodMainImg",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=s=>o.tempProduct.imageUrl=s)},null,512),[[d,o.tempProduct.imageUrl]]),t("img",{src:o.tempProduct.imageUrl,alt:"產品主要圖片",class:"img-fluid"},null,8,X)]),Y,Array.isArray(o.tempProduct.imagesUrl)?(r(),n(v,{key:0},[(r(!0),n(v,null,x(o.tempProduct.imagesUrl,(s,m)=>(r(),n("div",{class:"mb-1",key:m},[t("div",Z,[$,i(t("input",{"onUpdate:modelValue":y=>o.tempProduct.imagesUrl[m]=y,type:"text",class:"form-control",id:"prodOtherImg",placeholder:"請輸入圖片連結"},null,8,tt),[[d,o.tempProduct.imagesUrl[m]]])]),t("img",{class:"img-fluid",src:s,alt:"產品相關圖片"},null,8,et)]))),128)),!o.tempProduct.imagesUrl.length||o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length-1]?(r(),n("div",ot,[t("button",{type:"button",class:"btn btn-outline-main btn-sm d-block w-100",onClick:e[1]||(e[1]=()=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")])):(r(),n("div",st,[t("button",{type:"button",class:"btn btn-outline-accent btn-sm d-block w-100",style:{padding:"0.25rem 0.5rem"},onClick:e[2]||(e[2]=()=>o.tempProduct.imagesUrl.pop())}," 刪除圖片 ")]))],64)):(r(),n("div",lt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[3]||(e[3]=()=>l.$emit("create-images"))}," 新增圖片 ")])),t("div",it,[t("label",dt,[U("上傳圖檔 "),o.imgUploading?(r(),n("i",rt)):A("",!0)]),t("input",{type:"file",name:"file-to-upload",id:"customFile",class:"form-control mb-2",ref:"fileInput",onChange:e[4]||(e[4]=(...s)=>c.uploadFile&&c.uploadFile(...s))},null,544),nt,i(t("input",{type:"text",class:"form-control mb-2",id:"fileLink",placeholder:"請複製用於上方圖片連結","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.tempImage=s)},null,512),[[d,o.tempProduct.tempImage]])])]),t("div",at,[t("div",ct,[t("div",pt,[mt,i(t("input",{type:"text",class:"form-control",id:"prodTitle",placeholder:"請輸入品名","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.title=s)},null,512),[[d,o.tempProduct.title]])]),t("div",ut,[ht,i(t("input",{type:"text",class:"form-control",id:"prodCategory",placeholder:"請輸入類別","onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.category=s)},null,512),[[d,o.tempProduct.category]])])]),t("div",_t,[t("div",ft,[gt,i(t("input",{type:"text",class:"form-control",id:"prodPlace",placeholder:"請輸入產地","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.origin_place=s)},null,512),[[d,o.tempProduct.origin_place]])]),t("div",Pt,[bt,i(t("input",{type:"text",class:"form-control",id:"prodVariety",placeholder:"請輸入品種","onUpdate:modelValue":e[9]||(e[9]=s=>o.tempProduct.variety=s)},null,512),[[d,o.tempProduct.variety]])])]),t("div",vt,[t("div",yt,[Ut,i(t("input",{type:"text",class:"form-control",id:"prodAroma",placeholder:"請輸入香氣","onUpdate:modelValue":e[10]||(e[10]=s=>o.tempProduct.aroma=s)},null,512),[[d,o.tempProduct.aroma]])]),t("div",wt,[xt,i(t("input",{type:"text",class:"form-control",id:"prodTaste",placeholder:"請輸入滋味","onUpdate:modelValue":e[11]||(e[11]=s=>o.tempProduct.taste=s)},null,512),[[d,o.tempProduct.taste]])])]),t("div",kt,[t("div",Vt,[Mt,i(t("input",{type:"text",class:"form-control",id:"prodDried",placeholder:"請輸入茶乾","onUpdate:modelValue":e[12]||(e[12]=s=>o.tempProduct.tea_dried=s)},null,512),[[d,o.tempProduct.tea_dried]])]),t("div",It,[Ct,i(t("input",{type:"text",class:"form-control",id:"prodUnit",placeholder:"請輸入單位","onUpdate:modelValue":e[13]||(e[13]=s=>o.tempProduct.unit=s)},null,512),[[d,o.tempProduct.unit]])])]),t("div",Tt,[t("div",At,[Dt,i(t("input",{type:"number",min:"0",class:"form-control",id:"prodOrigin",placeholder:"請輸入原價","onUpdate:modelValue":e[14]||(e[14]=s=>o.tempProduct.origin_price=s)},null,512),[[d,o.tempProduct.origin_price,void 0,{number:!0}]])]),t("div",Lt,[Et,i(t("input",{type:"number",min:"0",class:"form-control",id:"prodPrice",placeholder:"請輸入售價","onUpdate:modelValue":e[15]||(e[15]=s=>o.tempProduct.price=s)},null,512),[[d,o.tempProduct.price,void 0,{number:!0}]])])]),Nt,i(t("textarea",{class:"form-control",id:"prodDescription",cols:"30",rows:"2",placeholder:"請輸入產品描述","onUpdate:modelValue":e[16]||(e[16]=s=>o.tempProduct.description=s)},null,512),[[d,o.tempProduct.description]]),Rt,i(t("textarea",{class:"form-control",id:"prodContent",cols:"30",rows:"2",placeholder:"請輸入說明內容","onUpdate:modelValue":e[17]||(e[17]=s=>o.tempProduct.content=s)},null,512),[[d,o.tempProduct.content]]),t("div",Ft,[i(t("input",{type:"checkbox",class:"form-check-input",id:"prodEnabled","onUpdate:modelValue":e[18]||(e[18]=s=>o.tempProduct.is_enabled=s),"true-value":1,"false-value":0},null,512),[[D,o.tempProduct.is_enabled]]),Ot])])])]),t("div",Bt,[t("button",{type:"button",class:"btn btn-outline-n500","data-bs-dismiss":"modal",onClick:e[19]||(e[19]=()=>l.$emit("cancel-product"))},"取消"),t("button",{type:"button",class:"btn btn-custom",style:{"padding-left":"1.5rem"},onClick:e[20]||(e[20]=()=>l.$emit("update-product"))},"確認")])])])],512)}const St=w(R,[["render",Ht]]),{VITE_APP_URL:f,VITE_APP_PATH:g}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_APP_PATH:"cheryl-hexschool",BASE_URL:"/vite-template/",MODE:"production",DEV:!1,PROD:!0},jt={props:["token"],data(){return{products:[],pagination:{},isNew:!1,tempProduct:{imagesUrl:[],tempImage:""},isLoading:!1,fullPage:!0}},methods:{getProducts(l=1){this.isLoading=!0,this.$http.get(`${f}api/${g}/admin/products/?page=${l}`).then(e=>{this.isLoading=!1,this.products=e.data.products,this.pagination=e.data.pagination}).catch(e=>{P.fire({icon:"error",title:e.response.data.message})})},openProduct(l,e){l==="new"?(this.isNew=!0,this.tempProduct={imagesUrl:[]},this.$refs.productModal.showModal()):l==="edit"?(this.isNew=!1,this.tempProduct={...e},this.$refs.productModal.showModal()):l==="delete"&&(this.tempProduct={...e},this.$refs.deleteModal.showModal())},cancelProduct(){this.tempProduct={imagesUrl:[]},this.$refs.productModal.hideModal()},updateProduct(){let l=`${f}api/${g}/admin/product`,e="post";this.isNew||(l=`${f}api/${g}/admin/product/${this.tempProduct.id}`,e="put"),this.tempProduct.tempImage="",this.$http[e](l,{data:this.tempProduct}).then(a=>{b.fire({icon:"success",title:a.data.message}),this.tempProduct={imagesUrl:[],tempImage:""},this.$refs.productModal.hideModal(),this.getProducts()}).catch(a=>{P.fire({icon:"error",title:a.response.data.message})})},createImages(){this.tempProduct.imagesUrl.push("")},deleteProduct(){const l=`${f}api/${g}/admin/product/${this.tempProduct.id}`;this.$http.delete(l).then(e=>{b.fire({icon:"success",title:e.data.message}),this.$refs.deleteModal.hideModal(),this.getProducts()}).catch(e=>{P.fire({icon:"error",title:e.response.data.message})})}},components:{Pagination:M,DelModal:T,ProdModal:St,Loading:I},mounted(){this.getProducts()}},qt=t("div",{class:"loadingio-spinner-spin-ekq2gap1645"},[t("div",{class:"ldio-kyayy0fncmo"},[t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")])])],-1),zt={class:"container",style:{"margin-top":"7vh"}},Gt={class:"pt-5"},Jt={class:"d-flex justify-content-between"},Kt={class:"mb-0 px-2 d-flex align-items-center"},Qt={class:"text-end"},Wt={class:"table table-hover mt-2"},Xt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",{width:"150"},"產品名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"150"}," 是否啟用 "),t("th",{width:"120"}," 編輯 ")])],-1),Yt={width:"120"},Zt={width:"150"},$t={width:"120"},te={width:"120"},ee={width:"150"},oe={key:0,class:"text-success"},se={key:1},le={width:"120"},ie=["onClick"],de=["onClick"],re={class:"row"},ne={class:"col"};function ae(l,e,a,k,o,c){const s=h("Loading"),m=h("Pagination"),y=h("ProdModal"),V=h("DelModal");return r(),n(v,null,[_(s,{active:o.isLoading,"onUpdate:active":e[0]||(e[0]=p=>o.isLoading=p),"can-cancel":!0,"is-full-page":o.fullPage},{default:L(()=>[qt]),_:1},8,["active","is-full-page"]),t("div",zt,[t("div",Gt,[t("div",Jt,[t("p",Kt,[U("本頁有 "),t("span",null,u(o.products.length),1),U(" 項產品")]),t("div",Qt,[t("button",{type:"button",class:"btn btn-custom text-light",onClick:e[1]||(e[1]=()=>c.openProduct("new",l.item)),style:{"padding-left":"1.5rem"}},"新增產品")])]),t("table",Wt,[Xt,t("tbody",null,[(r(!0),n(v,null,x(o.products,p=>(r(),n("tr",{key:p.id},[t("td",Yt,u(p.category),1),t("td",Zt,u(p.title),1),t("td",$t,u(p.origin_price),1),t("td",te,u(p.price),1),t("td",ee,[p.is_enabled?(r(),n("span",oe,"啟用")):(r(),n("span",se,"未啟用"))]),t("td",le,[t("button",{type:"button",class:"btn btn-outline-main btn-sm me-2 backendBtn",onClick:()=>c.openProduct("edit",p)},"編輯",8,ie),t("button",{type:"button",class:"btn btn-outline-accent btn-sm",onClick:()=>c.openProduct("delete",p),style:{padding:"0.25rem 0.5rem"}},"刪除",8,de)])]))),128))])]),t("div",re,[t("div",ne,[_(m,{pages:o.pagination,onChangePage:c.getProducts},null,8,["pages","onChangePage"])]),_(y,{product:o.tempProduct,isNew:o.isNew,ref:"productModal",onUpdateProduct:c.updateProduct,onCancelProduct:c.cancelProduct,onCreateImages:c.createImages},null,8,["product","isNew","onUpdateProduct","onCancelProduct","onCreateImages"]),_(V,{"temp-data":o.tempProduct,ref:"deleteModal",onDelData:c.deleteProduct},null,8,["temp-data","onDelData"])])])])],64)}const he=w(jt,[["render",ae]]);export{he as default};
